# This workflow will do a clean installation of node dependencies, cache/restore them, build the source code and run tests across different versions of node
# For more information see: https://help.github.com/actions/language-and-framework-guides/using-nodejs-with-github-actions

name: lshboshethNest CI

on:
  push:
    branches:
      - master

jobs:
  build:

    runs-on: ubuntu-latest

    steps:
    - name: Checkout # å®šä¹‰ step çš„åå­—ï¼Œæ–¹ä¾¿ä½œæ—¥å¿—æ’æŸ¥
      uses: actions/checkout@v3
    - name: Deploy ğŸš€
      uses: cross-the-world/ssh-scp-ssh-pipelines@latest
      env:
        WELCOME: "ssh scp ssh pipelines"
        LASTSSH: "Doing something after copying"
      with:
       host: ${{ secrets.DR_HOST }}
       user: ${{ secrets.DR_USER }}
       pass: ${{ secrets.DR_PASS }}
       connect_timeout: 100000s
       first_ssh: |
        rm -rf /home/lshboshethNest
       scp: |
            ./* => /home/lshboshethNest
       last_ssh: |
        # cd /home/lshboshethNest
        # source ~/.bashrc   # å¼ºåˆ¶åŠ è½½ç”¨æˆ·ç¯å¢ƒ
        # npm i
         cd /home/lshboshethNest && pwd # ç¡®è®¤å½“å‰ç›®å½•
         source ~/.bashrc && echo "Bash environment sourced" # ç¡®è®¤ç¯å¢ƒå˜é‡å·²åŠ è½½
         npm i --verbose && echo "npm install completed" # ä½¿ç”¨--verboseé€‰é¡¹è·å–æ›´è¯¦ç»†çš„è¾“å‡º
