name: lshboshethNest CI

on:
  push:
    branches: [ master ]

jobs:
  build-and-deploy:
    runs-on: ubuntu-22.04  # ä½¿ç”¨æœ€æ–°çš„LTSç‰ˆæœ¬
    
    steps:
    - name: Checkout ðŸ›Žï¸
      uses: actions/checkout@v4
      
    - name: Set up Node.js
      uses: actions/setup-node@v3
      with:
        node-version: '22' # æˆ–è€…æŒ‡å®šå…·ä½“çš„ç‰ˆæœ¬å·ï¼Œå¦‚ '22.x'

    - name: Install dependencies
      run: npm ci # ä¸¥æ ¼ä¾èµ–é”å®šï¼ˆä¼˜äºŽ npm installï¼‰

    - name: Deploy ðŸš€
      uses: cross-the-world/ssh-scp-ssh-pipelines@latest
      env:
        WELCOME: "ssh scp ssh pipelines"
        LASTSSH: "Doing something after copying"
      with:
        host: ${{ secrets.DR_HOST }}
        user: ${{ secrets.DR_USER }}
        pass: ${{ secrets.DR_PASS }}
        connect_timeout: 10s
        first_ssh: |
          rm -rf /home/lshboshethNest
        scp: |
          ./* => /home/lshboshethNest
        last_ssh: |
          cd /home/lshboshethNest
